{{$.Scratch.Set "env" .Site.Params.environment}}
{{ with .Params.mediaSections }}
<section class="opt-media-section">
    {{range $i, $section := .}}
    <div class="opt-media-section-content">

        {{ with $section.headline }}
        <div class="opt-media-section__headlines">
            <h2 class="sc-font-xl sc-text-center">{{.}}</h2>
            {{ with $section.subheadline }}<h3 class="sc-font-l sc-text-center sc-margin-top-xs">{{.}}</h3>{{end}}
        </div>
        {{end}}

        <div class="sc-media-section {{ if not (modBool $i 2) }} sc-media-section--reverse {{ end }}">
            <div class="sc-media-section__pic">
                {{ if eq (len $section.images) 1 }}
                    <picture class="gallery-picture__image">
                    {{ if (index $section.images 0).large }}
                        {{if eq ($.Scratch.Get "env") "live"}}
                        <source media="(max-width: 480px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{ replace (index $section.images 0).small "jpg" "webp" }}" type="image/webp">
                        <source media="(max-width: 768px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{ replace (index $section.images 0).medium "jpg" "webp" }}" type="image/webp">
                        <source media="(min-width: 768px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{ replace (index $section.images 0).large "jpg" "webp" }}" type="image/webp">
                        {{ end }}
                        <source media="(max-width: 480px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{(index $section.images 0).small}}" type="image/jpg">
                        <source media="(max-width: 768px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{(index $section.images 0).medium}}" type="image/jpg">
                        <source media="(min-width: 768px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{(index $section.images 0).large}}" type="image/jpg">
                    {{ else }}
                        {{if eq ($.Scratch.Get "env") "live"}}
                        <source media="(max-width: 480px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{ replace (index $section.images 0).small "jpg" "webp" }}" type="image/webp">
                        <source media="(min-width: 481px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{ replace (index $section.images 0).medium "jpg" "webp" }}" type="image/webp">
                        {{ end }}
                        <source media="(max-width: 480px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{(index $section.images 0).small}}" type="image/jpg">
                        <source media="(min-width: 481px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{(index $section.images 0).medium}}" type="image/jpg">
                    {{ end }}
                        <img src="{{ $.Site.Params.assetsBaseURL}}{{(index $section.images 0).medium}}" alt="{{(index $section.images 0).alt}}">
                    </picture>
                {{ else }}
                    <as24-carousel loop="infinite">
                        <div class="as24-carousel__container" role="container">
                            {{range $j, $element := $section.images}}
                            <div class="as24-carousel__item">
                                <div class="gallery-picture">
                                    <picture class="gallery-picture__image">
                                    {{ if $element.large }}
                                        {{if eq ($.Scratch.Get "env") "live"}}
                                        <source media="(max-width: 480px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{ replace $element.small "jpg" "webp" }}" type="image/webp">
                                        <source media="(max-width: 768px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{ replace $element.medium "jpg" "webp" }}" type="image/webp">
                                        <source media="(min-width: 768px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{ replace $element.large "jpg" "webp" }}" type="image/webp">
                                        {{ end }}
                                        <source media="(max-width: 480px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{$element.small}}" type="image/jpg">
                                        <source media="(max-width: 768px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{$element.medium}}" type="image/jpg">
                                        <source media="(min-width: 768px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{$element.large}}" type="image/jpg">
                                    {{ else }}
                                        {{if eq ($.Scratch.Get "env") "live"}}
                                        <source media="(max-width: 480px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{ replace $element.small "jpg" "webp" }}" type="image/webp">
                                        <source media="(min-width: 481px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{ replace $element.medium "jpg" "webp" }}" type="image/webp">
                                        {{ end }}
                                        <source media="(max-width: 480px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{$element.small}}" type="image/jpg">
                                        <source media="(min-width: 481px)" srcset="{{ $.Site.Params.assetsBaseURL}}{{$element.medium}}" type="image/jpg">
                                    {{ end }}
                                        <img src="{{ $.Site.Params.assetsBaseURL}}{{$element.medium}}" alt="{{$element.alt}}">
                                    </picture>
                                </div>
                            </div>
                            {{end}}
                        </div>
                        <a href="#" class="as24-carousel__button" role="nav-button" data-direction="left"></a>
                        <a href="#" class="as24-carousel__button" role="nav-button" data-direction="right"></a>
                    </as24-carousel>
                {{end}}
            </div>
            <div class="sc-media-section__content sc-margin-top-l">
                {{ with $section.textheadline}}
                <h3 class="sc-font-l sc-padding-bottom-m sc-font-bold">{{.}}</h3>
                {{end}}
                {{ with $section.text }}
                <p class="sc-padding-bottom-xl">
                    {{. | safeHTML}}
                </p>
                {{end}}
                {{ with $section.links }}
                {{ if gt (len .) 0 }}
                <ul class="sc-unique-link-list">
                    {{range $k, $link := .}}
                    <li>
                        <a href="{{ $link.url }}">
                            <span>{{ $link.name }}</span>
                        </a>
                    </li>
                    {{end}}
                </ul>
                {{end}}
                {{end}}
            </div>
        </div>
    </div>
    {{end}}
</section>
<script>
    !function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){"use strict";function t(){this.carousel=new X(this),this.carousel.attached()}function e(){this.carousel.detached(),delete this.carousel}var i=function(t,e){return e.classList.add(t),e},n=function(t,e){return e.classList.remove(t),e},r=function(t,e,r){return r?(i(t,e),!0):(n(t,e),!1)},o=function(t,e){return Array.prototype.forEach.call(e,t)},s=function(t,e){for(var i in e)t[i]=e[i]},a=function(t){return Array.from(t).map(function(t,e){return e})},u=function(t,e,i){var n=t*e;return n>i?i:n},c=function(t,e,i,n,r){var o=n+e;return"infinite"===t?o<0?i-r:o>i-r?0:o:"finite"===t?(o=n+e,o<0?0:o>i-r?i-r:o):void 0},h=function(t,e){var i=e.element,n=e.container,r=(e.itemsOrder,e.mode),o=(e.offset,e.index),s=(e.pagination,v(i,n).itemsVisible);return c(r,t,n.children.length,o,s)},l=function(t){var e=null!==t?getComputedStyle(t):null;return null!==e&&"none"!==e.display},d=function(t){return t.map(l).reduce(function(t,e){return t&&e},!0)},f=function(t,e){var i=getComputedStyle(t),n=i.width,r=i.marginLeft,o=i.marginRight,s=i.paddingLeft,a=i.paddingRight,u=i.boxSizing,c=e?parseFloat(r)+parseFloat(o):0,h="border-box"===u?0:parseFloat(s)+parseFloat(a);return parseFloat(n)+h+c},v=function(t,e){var i=f(t,!1),n="infinite"===t.getAttribute("loop")?t.getBoundingClientRect().width:f(e.children.item(0),!0),r=Math.floor(Array.from(e.children).reduce(function(t,e){return t+=f(e,!0)},0));return{maxOffset:Math.floor(r-i),stepWidth:n,itemsVisible:Math.floor((0|i)/(0|n)),rootElemWidth:i,totalWidth:r}},m=function(t,e,i){return i.map(function(i,n){return t(e[n],i)})},p=function(t,e){var i=null;return function(){i||(t(),i=setTimeout(function(){clearTimeout(i),i=null},e))}},g=function(t){var e=t.touches&&t.touches[0];return new y(t.clientX||e&&e.clientX,t.clientY||e&&e.clientY)},y=function(){function t(t,e){this.x=t,this.y=e}return t}(),b=function(t,e,i,n){return!(!t||!e)&&(r("as24-carousel__button--hidden",t,!i),r("as24-carousel__button--hidden",e,!n),!0)},x=function(t,e,i){return t.dispatchEvent(new CustomEvent("as24-carousel.slide",{detail:{id:t.id,role:t.getAttribute("role"),direction:e,index:i},bubbles:!0}))},w=function(t,e,i){return!!t&&(t.innerHTML=e+"/"+i,!0)},S=function(t,e){return t.style.transform="translateX("+-1*e+"px)",t.style.webkitTransform="translateX("+-1*e+"px)",!0},E=function(t,e){return t.style.WebkitOrder=e.toString(),t.style.order=e.toString(),e},L=function(t,e){return m(E,t,e)},_=function(t,e,r){return e.forEach(function(t){return n("as24-carousel__item--invisible",t)}),r.forEach(function(n,r){n>t-1&&i("as24-carousel__item--invisible",e[r])}),e},A=function(t,e,i){var r=e.element,o=e.container,s=e.offset,a=e.index,c=e.pagination,l=e.itemsOrder,d=v(r,o),f=d.rootElemWidth,m=d.stepWidth,p=d.maxOffset,g=(d.itemsVisible,d.totalWidth);n("as24-carousel__container--static",o),a=h(t,e);var y=f>g?0:u(a,m,p);return p<0?b(c.left,c.right,!1,!0):b(c.left,c.right,y>0,y<p),Math.abs(s-y)>0&&i&&x(r,t,a),w(c.indicator,a+1,o.children.length),S(o,y),{touchStart:null,index:a,offset:y,itemsOrder:l,isSwiping:!1,swipeDir:void 0}},O=function(t,e){var n=e.offset,r=e.index,o=e.container,s=e.itemsOrder;return i("as24-carousel__container--static",o),{touchStart:t,index:r,offset:n,itemsOrder:s,isSwiping:void 0,swipeDir:void 0}},I=function(t,e){var i=e.offset,n=e.touchStart,r=e.index,o=e.container,s=e.itemsOrder,a=e.isSwiping,u=e.swipeDir,c=Math.abs(t.x-n.x),h=Math.abs(t.y-n.y);if(a){var l=i+-1*(t.x-n.x);S(o,l)}return{index:r,offset:i,touchStart:n,swipeDir:u,itemsOrder:s,isSwiping:void 0===a?c/h>.6:a}},M=function(t,e){var i=(e.index,e.offset,e.touchStart),n=(e.container,e.isSwiping);if(i){var r=i.x-t.x>0?1:-1;return n?A(r,e,!0):void 0}},R=function(t,e){var i=e.slice(e.length-t,e.length),n=e.slice(0,e.length-t);return i.concat(n)},T=function(t,e){var r=t.element,o=t.container,s=t.itemsOrder,u=(t.offset,t.index,v(r,o).stepWidth,Array.from(o.children));return e?n("as24-carousel__container--static",o):(i("as24-carousel__container--static",o),void 0!==s&&_(2,u,L(u,s))),S(o,0),t.itemsOrder=a(o.children),t.busy=!1,t},D=function(t,e,r){var o=e.element,s=e.container,u=e.touchStart,c=e.offset,l=e.index,d=e.pagination,f=e.mode,m=v(o,s),p=m.stepWidth,g=(m.itemsVisible,Array.from(s.children));l=0!==t?h(t,e):l,c=-1===t?0===c?t*p:t*c:t*p;var y=a(s.children),b=R(l,y),E=!0;return t<0?(i("as24-carousel__container--static",s),_(2,g,L(g,b)),S(s,-1*c),T(e,!0)):t>0?(n("as24-carousel__container--static",s),S(s,c)):(i("as24-carousel__container--static",s),S(s,c),_(2,g,L(g,b)),E=!1),r&&x(o,t,l),w(d.indicator,l+1,s.children.length),{index:l,touchStart:u,offset:0,itemsOrder:b,busy:E,isSwiping:!1,swipeDir:void 0,element:o,container:s,mode:f,pagination:d}},W=function(t,e){var n=(e.offset,e.index),r=e.container,o=e.itemsOrder;return i("as24-carousel__container--static",r),{touchStart:t,index:n,offset:0,itemsOrder:o,isSwiping:void 0,swipeDir:void 0}},C=function(t,e){var i,n,r=e.touchStart,o=e.index,s=e.container,u=e.element,c=e.isSwiping,l=e.swipeDir,d=0,f=Math.abs(t.x-r.x),m=Math.abs(t.y-r.y),p=v(u,s),g=p.stepWidth;p.itemsVisible;return void 0===l&&(l=r.x-t.x>0?1:-1),c&&(-1===l?(i=R(h(l,e),a(s.children)),n=Array.from(s.children),_(2,n,L(n,i)),d=r.x-t.x>0?g:g+-1*(t.x-r.x)):d=r.x-t.x<0?0:-1*(t.x-r.x),S(s,d)),{index:o,touchStart:r,offset:d,itemsOrder:i,swipeDir:l,isSwiping:void 0===c?f/m>.6:c}},H=function(t,e){var i=(e.index,e.offset,e.touchStart),r=e.container,o=e.isSwiping,s=e.swipeDir;if(o){n("as24-carousel__container--static",r);var a=-1===s&&i.x-t.x>0,u=1===s&&i.x-t.x<0;return a||u?D(0,e,!1):D(s,e,!0)}},k=function(t,e,i){switch(void 0===i&&(i=!0),e.mode){case"infinite":return D(t,e,i);case"finite":return A(t,e,i)}},q=function(t,e){switch(e.mode){case"infinite":return W(t,e);case"finite":return O(t,e)}},z=function(t,e){switch(e.mode){case"infinite":return C(t,e);case"finite":return I(t,e)}},F=function(t,e){switch(e.mode){case"infinite":return H(t,e);case"finite":return M(t,e)}},V=HTMLElement.prototype.querySelector,X=function(){function t(t){this.swipeDir=void 0,this.isSwiping=void 0,this.busy=!1,this.index=0,this.offset=0,this.mode="finite",this.autoRotateInterval=0,this.pagination={left:null,right:null,indicator:null},this.element=t}return t.prototype.attached=function(){var t=this;this.touchStart=new y(0,0),this.mode=this.element.getAttribute("loop")||"finite",this.autoRotateInterval=this.element.getAttribute("auto-rotate-interval")||0,this.container=V.call(this.element,'[role="container"]'),this.container.addEventListener("transitionend",function(e){return t.busy=!1}),"infinite"===this.mode&&this.container.addEventListener("transitionend",function(e){s(t,T(t,!1))}),this.resizeListener=p(k.bind(null,0,this.mode,this),100),this.touchStartListener=this.touchStartEventHandler.bind(this),this.touchMoveListener=this.touchMoveEventHandler.bind(this),this.touchEndListener=this.touchEndEventHandler.bind(this),window.addEventListener("resize",this.resizeListener),this.element.addEventListener("touchstart",this.touchStartListener),this.element.addEventListener("touchmove",this.touchMoveListener),this.element.addEventListener("touchend",this.touchEndListener),"touchend"in window||o(function(e){var i=e.getAttribute("data-direction");t.pagination[e.getAttribute("data-direction")]=e,e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),s(t,k("left"===i?-1:1,t))})},this.element.querySelectorAll('[role="nav-button"]')),this.pagination.indicator=this.element.querySelector('[role="indicator"]'),this.index=0,s(this,k(0,this,!1)),this.busy=!1,this.autoRotateInterval>0&&this.setupAutoRotate()},t.prototype.detached=function(){window.removeEventListener("resize",this.resizeListener,!0),this.element.removeEventListener("touchstart",this.touchStartListener,!0),this.element.removeEventListener("touchmove",this.touchMoveListener,!0),this.element.removeEventListener("touchend",this.touchEndListener,!0)},t.prototype.touchStartEventHandler=function(t){var e=t.target;if(e.classList.contains("as24-carousel__button")&&(t.preventDefault(),t.stopPropagation()),!this.busy)if(e.classList.contains("as24-carousel__button")){var i=e.dataset.direction;s(this,k("left"===i?-1:1,this))}else{var n=Array.from(this.element.querySelectorAll('[role="nav-button"]'));if(!d(n))return;s(this,q(g(t),this))}},t.prototype.touchMoveEventHandler=function(t){var e=t.target,i=Array.from(this.element.querySelectorAll('[role="nav-button"]'));this.busy||(this.isSwiping&&t.preventDefault(),d(i)&&(e.classList.contains("as24-carousel__button")||s(this,z(g(t),this))))},t.prototype.touchEndEventHandler=function(t){var e=Array.from(this.element.querySelectorAll('[role="nav-button"]')),i=g(t.changedTouches[0]);!d(e)||this.touchStart&&this.touchStart.x===i.x||s(this,F(i,this))},t.prototype.goTo=function(t,e){this.index=--t,this.index=h(0,this),this.touchStart=new y(0,0),s(this,k(0,this,e.notify)),this.busy=!1},t.prototype.getIndex=function(){return this.index},t.prototype.redraw=function(t){void 0===t&&(t=!0),s(this,k(0,this,t)),this.busy=!1},t.prototype.removeItem=function(t){this.container.children[t].remove(),this.busy=!1,this.goTo(1,{notify:!1})},t.prototype.setupAutoRotate=function(){var t=this;this.autoRotateIntervalId=setInterval(function(){s(t,k(1,t))},this.autoRotateInterval),this.addOneTimeEventListener(this.element,"touchstart",this.stopAutoRotate.bind(this)),this.addOneTimeEventListener(this.element,"click",this.stopAutoRotate.bind(this))},t.prototype.stopAutoRotate=function(){this.autoRotateIntervalId&&(clearInterval(this.autoRotateIntervalId),this.autoRotateIntervalId=0)},t.prototype.addOneTimeEventListener=function(t,e,i){var n=function n(){i(),t.removeEventListener(e,n,!0)};t.addEventListener(e,n,!0)},t}();try{document.registerElement("as24-carousel",{prototype:Object.assign(Object.create(HTMLElement.prototype,{attachedCallback:{value:t},detachedCallback:{value:e},attributeChangedCallback:{value:function(){}}}),{goTo:function(t,e){this.carousel.goTo(t,e||{notify:!0})},getIndex:function(){return this.carousel.index},redraw:function(t){this.carousel.redraw(t)},removeItem:function(t){this.carousel.removeItem(t)}})})}catch(t){window&&window.console&&window.console.warn('Failed to register CustomElement "as24-carousel".',t)}});
</script>
{{ end }}
